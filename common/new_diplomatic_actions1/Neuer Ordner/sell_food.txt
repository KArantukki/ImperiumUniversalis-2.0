

sell_food = {
	category = economy
	alert_index = 21
	alert_tooltip = sell_food_tt
	require_acceptance = yes # Whether the recipient gets an option to decline
	is_visible = {
		has_global_flag = food_active
		FROM = {
			any_owned_province = { 
				OR = {
					base_tax = 1
					base_production = 1
				}
			}
			NOT = { border_distance = { who = ROOT  distance = 600 } }
		}
			any_owned_province = { 
				OR = {
					base_tax = 1
					base_production = 1
				}
			}
			any_owned_province = { 
				OR = {
						trade_goods = fish
						trade_goods = meat_animals
						trade_goods = honey
						trade_goods = grain
						trade_goods = wine
						trade_goods = spices
						trade_goods = fruits
						trade_goods = olive
						trade_goods = rice
						trade_goods = tea_good
				}
			}
		
	}
	is_allowed = {
				NOT = { war_with = FROM }
				FROM = { NOT = { trade_embargo_by = ROOT } }
				check_variable = { which = food_supplies value = 50 }  
	}
	on_accept = {
		hidden_effect = {	# Just to be sure that flags are removed, before event triggers
			FROM = {
					change_variable = { which = food_supplies value = 50 }
					add_treasury = -15
								while = {
									limit = {
											check_variable = { which = food_supplies which = storage_capacity } 
									}
									set_variable = { which = food_supplies which = storage_capacity }
								}
			}
					change_variable = { which = food_supplies value = -50 }
					add_treasury = 15
								while = {
									limit = {
											check_variable = { which = food_supplies which = storage_capacity } 
									}
									set_variable = { which = food_supplies which = storage_capacity }
								}
		}
	}
	on_decline = {
		# No Effect
	}
	ai_acceptance = {	

		
		add_entry = {
			name = FIGHTING_FAMINE
			limit = {
				FROM = {
					has_disaster_progress = { disaster = famine_disaster value = 25 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = 1 }
		}
		
		add_entry = {
			name = FAMINE_HAPPENED
			limit = {
				FROM = {
					has_disaster = famine_disaster
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = 1 }
		}
		
		add_entry = {
			name = ALLIED_NATION
			limit = {
				FROM = {
					alliance_with = ROOT
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = 1 }
		}
		
		add_entry = {
			name = COUNTRY_SIZE
			export_to_variable = {
				which = ai_value
				value = states_development
				who = FROM
			}
			multiply_variable = { which = ai_value value = 0.04 }
		}
		
		add_entry = {
			name = MONEY_VAL
			export_to_variable = {
				which = ai_value
				value = treasury
				who = FROM
			}
			multiply_variable = { which = ai_value value = 0.1 }
		}
		
		
		add_entry = {
			name = AMOUNT_FOOD
			limit = {
				FROM = {
					NOT = { check_variable = { which = food_supplies which = storage_25 }  }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = 1 }
		}
		
		
		# Negative Values ##########################################
		
		
		add_entry = {
			name = AMOUNT_FOOD
			limit = {
				FROM = {
							check_variable = { which = food_supplies which = storage_25 } 
					NOT = { check_variable = { which = food_supplies which = storage_50 }  }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		
		add_entry = {
			name = AMOUNT_FOOD
			limit = {
				FROM = {
							check_variable = { which = food_supplies which = storage_50 } 
					NOT = { check_variable = { which = food_supplies which = storage_75 }  }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		
		add_entry = {
			name = AMOUNT_FOOD
			limit = {
				FROM = {
							check_variable = { which = food_supplies which = storage_75 } 
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		
		add_entry = {
			name = BASE_REJECTION
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1.0 }
		}
		
	}
	ai_will_do = {
			factor = 1	
				modifier = {
					factor = 0.0
					NOT = { check_variable = { which = food_supplies which = storage_25 } }
				}
				modifier = {
					factor = 0.5
							check_variable = { which = food_supplies which = storage_25 } 
					NOT = { check_variable = { which = food_supplies which = storage_50 } }
				}
				modifier = {
					factor = 1.5
							check_variable = { which = food_supplies which = storage_50 } 
					NOT = { check_variable = { which = food_supplies which = storage_75 } }
				}
				modifier = {
					factor = 2.5
							check_variable = { which = food_supplies which = storage_75 } 
				}
				
				modifier = {
					factor = 1.25
					check_variable = { which = food_supplies value = 600 }
				}
				modifier = {
					factor = 0.5
					all_owned_province = { has_province_modifier = weather_dry } 
				}
				modifier = {
					factor = 0.1
						has_disaster_progress = { disaster = famine_disaster value = 1 }
				}
				modifier = {
					factor = 0.0
						has_disaster = famine_disaster
				}
				modifier = {
					factor = 1.25
						NOT = { treasury = 50 }
				}
				modifier = {
					factor = 1.25
						NOT = { treasury = 10 }
				}
				modifier = {
					factor = 1.5
						num_of_loans = 2
				}
				modifier = {
					factor = 1.5
						num_of_loans = 5
				}
				modifier = {
					factor = 1.5
						num_of_loans = 10
				}
				modifier = {
					factor = 0.5
						is_at_war = yes
				}
				modifier = {
					factor = 0.5
						is_month = 7
						NOT = { is_month = 1 }
				}
				modifier = {
					factor = 2.0
						is_month = 4
						NOT = { is_month = 7 }
				}
				modifier = {
					factor = 0.5
						FROM = { ai = no }
				}
				modifier = {
					factor = 1.25
							has_opinion = {
								who = FROM
								value = 100
							}
				}
		}
}
